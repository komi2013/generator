<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8" />
		<title>My Quiz</title>
    <script src="/public/third/jquery-2.1.1.min.js"></script>
    <script src="/public/third/jquery.cookie.js"></script>
    <meta name="viewport" content="width=device-width, user-scalable=no" >
	</head>
<body>

<style type="text/css">
body {
  margin: 0 auto;
  font-size: 18pt;
}
</style>

<table cellspacing="0" id="header">
  <td id="left"><img src="/public/img/icon/menu.png" height="40"></td>
  <td id="center">My Quiz</td>
  <td id="right">
    <img src="/public/img/icon/check0.png" height="40" id="generate">
    <img src="/public/img/icon/check1.png" height="40" id="success">
  </td>
</table>
<table id="drawer" cellspacing="1" boroder="0">
  <tr><td><a href="/myquestion/">My Quiz</a></td></tr>
  <tr><td><a href="/myanswer/">My Answer</a></td></tr>
  <tr><td><a href="/other/">Other</a></td></tr>
  <tr><td><a href="/news/">News</a></td></tr>
  <tr><td><a href="/contact/">Contact</a></td></tr>
  <tr><td><a href="/rule/">Rule</a></td></tr>
</table>

<script>
$(function(){
  var width = $(window).width();
  var drawerIsOpen = false;
  $('#left').click(function(){
    if(drawerIsOpen){
      $('#drawer').css({
        'left': -width
      });
      drawerIsOpen = false;
    }else{
      $('#drawer').css({
        'left': 0
      });
      drawerIsOpen = true;
    }
  });
  $('#drawer').css({
    'width': width * 80/100,
    'overflow': 'scroll',
    'display': 'block',
    'position': 'absolute',
    'z-index': 10,
    'margin': 0,
    'top': 50,
    'left': -width
  });
  $('#drawer td').css({
    'width': width * 80/100,
    'height': 50,
    'background-color': '#996666'
  });
  $('#header').css({
    'background-color': '#996666',
    'height': 50
  });
  
  $('#left').css({
    'width': $(window).width() / 4,
    'text-align': 'center',
  });
  
  $('#center').css({
    'width': ($(window).width() / 2) -2,
    'text-align': 'center'
  });
  
  $('#right').css({
    'width': $(window).width() / 4,
    'text-align': 'center'
  });
  $('#success').css({
    'display': 'none'
  });
});

</script>
<img src="/public/img/icon/no_image.jpg" id="photo">
<br>
<textarea placeholder="Q." maxlength="140" id="question"></textarea>

<input type="text" placeholder="O" maxlength="12" class="choice" id="choice_1">
<input type="text" placeholder="X" maxlength="12" class="choice" id="choice_2">
<input type="text" placeholder="X" maxlength="12" class="choice" id="choice_3">
<input type="text" placeholder="X" maxlength="12" class="choice" id="choice_4">


<br>
<br>
<div id="add_url">
<?php if(isset($question)){ foreach($question as $k => $d){ ?>
  <a href="/quiz/?q=<?=$d->id?>"><?=substr($d->txt, 0, 20)?></a>
<?php }} ?>
</div>

<script>

$(function(){
  var width = $(window).width();
  $('#question').css({
    'height': 90,
    'width': width * 98/100,
    'font-size': '18pt'
  });
  $('.choice').css({
    'height': 40,
    'width': width * 98/100,
    'font-size': '18pt'
  });
  $('#file_area').css({
    'width': width * 98/100,
    'height': 40,
    'position': 'relative',
    'overflow': 'hidden',
    'background':'url("/public/img/icon/tv.png") no-repeat',
    'background-position': 'center',
    'background-size': '40px 40px',
    'border-style': 'solid',
    'border-width': '1px'
  });
  $('#imageLoader').css({
    'width': width * 98/100,
    'height': 40,
    'opacity': 0,
    'position': 'absolute',
    'z-index': 8,
  });
  $('#photo').css({
    'width': width,
    'height': width
  });

});

var childWindow;
$('#photo').click(function() {
  childWindow = window.open("/public/html/photo.html", "winB");
});
// var img_path = '';
function winCloseB(){
  childWindow.close();
  console.log('close');
//   return;
  var url_1 = '/photoquizadd/';
  var param = {
    img : localStorage.getItem('img')
  };
	$.ajax({type:'POST',dataType:'json',url:url_1,data:param})
  .always(function(data){
    if(data[0] == 1){
//       $('#save').css({'display': 'none'});  
//       $('#success').css({'display': 'block'});
//       localStorage.removeItem('img');
//       img_path = data[1];
    }else{
      console.log(data);
      alert('通信エラー');
    }
  });
}

$('#question').click(function(){
  $('#question').css({'border-color':'black'});
});
$('#choice_1').click(function(){
  $('#choice_1').css({'border-color':'black'});
});
$('#choice_2').click(function(){
  $('#choice_2').css({'border-color':'black'});
});
$('#choice_3').click(function(){
  $('#choice_3').css({'border-color':'black'});
});
$('#choice_4').click(function(){
  $('#choice_4').css({'border-color':'black'});
});

$('#generate').click(function() {
  var validate = 1;
  if($('#question').val()==''){
    $('#question').css({'border-color':'red'});
    validate=2;
  }
  if($('#choice_1').val()==''){
    $('#choice_1').css({'border-color':'red'});
    validate=2;
  }
  if($('#choice_2').val()==''){
    $('#choice_2').css({'border-color':'red'});
    validate=2;
  }
  if($('#choice_3').val()==''){
    $('#choice_3').css({'border-color':'red'});
    validate=2;
  }
  if($('#choice_4').val()==''){
    $('#choice_4').css({'border-color':'red'});
    validate=2;
  }
  if(validate==2){
    return;
  }
  var url_1 = '/myquestionadd/';
  var param = {
    question : $('#question').val(),
    choice_1 : $('#choice_1').val(),
    choice_2 : $('#choice_2').val(),
    choice_3 : $('#choice_3').val(),
    choice_4 : $('#choice_4').val(),
    photo : $.cookie('quiz_photo')
  };
  $.post(url_1,param,function(res){
    if(res[0]==1){
      $('#generate').css({'display': 'none'});  
      $('#success').css({'display': 'block'});
      $('#success').append('<a href="/quiz/?q='+res[1]+'">'+$('#question').val()+'</a>');
      localStorage.removeItem('img');
      $.cookie('quiz_photo','',{expires:-1,path:'/'});  
    }else{
     console.log(res);
     alert('通信エラー');
    }
  }, "json");  
});

</script>
<a href=""></a>
</body>
</html>
